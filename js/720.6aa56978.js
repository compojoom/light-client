(globalThis["webpackChunkraiden_dapp"]=globalThis["webpackChunkraiden_dapp"]||[]).push([[720],{41541:(t,e,a)=>{"use strict";a.d(e,{Z:()=>i});a(7249);var n=a(64171);const i=(0,n.Ji)("spacer","div","v-spacer")},19261:(t,e,a)=>{"use strict";a.d(e,{Z:()=>_});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"amount-display",class:{"amount-display--inline":t.inline,"amount-display--full-width":t.fullWidth},on:{mouseover:function(e){t.exactAmount&&(t.displayExactAmount=!0)},mouseleave:function(e){t.exactAmount&&(t.displayExactAmount=!1)}}},[t.showLabel?a("span",{staticClass:"amount-display__label"},[t._v(" "+t._s(t.label)+" ")]):t._e(),t._t("default",(function(){return[a("span",{staticClass:"amount-display__formatted-amount",class:{"amount-display__formatted-amount--warning":t.warning}},[t._v(" "+t._s(t.formattedAmount)+" ")])]}))],2)},i=[],o=a(59312),s=a(3922),r=a(57102),d=a(93840);let c=class extends r.w3{constructor(){super(...arguments),this.displayExactAmount=!1}get showLabel(){return void 0!==this.label}get exactAmountValue(){const t=s.O$.from(this.amount);return d.Z.toUnits(t,this.token.decimals)}get roundedAmountValue(){const t=s.O$.from(this.amount);return d.Z.displayFormat(t,this.token.decimals)}get formattedAmount(){let t=this.sign;return t+=this.displayExactAmount?this.exactAmountValue:this.roundedAmountValue,t+=" "+this.token.symbol,t}};(0,o.__decorate)([(0,r.fI)({required:!1,default:!1,type:Boolean})],c.prototype,"exactAmount",void 0),(0,o.__decorate)([(0,r.fI)({type:String,required:!1})],c.prototype,"label",void 0),(0,o.__decorate)([(0,r.fI)({required:!0})],c.prototype,"amount",void 0),(0,o.__decorate)([(0,r.fI)({type:String,default:""})],c.prototype,"sign",void 0),(0,o.__decorate)([(0,r.fI)({required:!0})],c.prototype,"token",void 0),(0,o.__decorate)([(0,r.fI)({required:!1,default:!1,type:Boolean})],c.prototype,"inline",void 0),(0,o.__decorate)([(0,r.fI)({type:Boolean,default:!1})],c.prototype,"fullWidth",void 0),(0,o.__decorate)([(0,r.fI)({type:Boolean,default:!1})],c.prototype,"warning",void 0),c=(0,o.__decorate)([r.wA],c);const l=c,u=l;var p=a(79917),h=(0,p.Z)(u,n,i,!1,null,"97172a00",null);const _=h.exports},54457:(t,e,a)=>{"use strict";a.d(e,{Z:()=>D});var n,i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("raiden-dialog",{attrs:{visible:t.visible},on:{close:t.cancel}},[t.error?t._e():a("v-card-title",[t._v(" "+t._s(t.$t("udc-deposit-dialog.title"))+" ")]),t.error?t._e():a("v-card-subtitle",{staticClass:"udc-deposit-dialog__balance"},[t._v(" "+t._s(t.$t("udc-deposit-dialog.available-utility-token",{utilityTokenSymbol:t.udcToken.symbol,utilityTokenBalance:t.utilityTokenBalance}))+" ")]),a("v-card-text",[t.loading||t.error?t.error?a("error-message",{attrs:{error:t.error}}):a("div",{staticClass:"udc-deposit-dialog--progress"},[a("spinner"),t.currentStepDescription?a("span",[t._v(" "+t._s(t.currentStepDescription)+" ")]):t._e()],1):a("amount-input",{attrs:{token:t.udcToken,placeholder:t.$t("transfer.amount-placeholder")},model:{value:t.defaultUtilityTokenAmount,callback:function(e){t.defaultUtilityTokenAmount=e},expression:"defaultUtilityTokenAmount"}}),!t.mainnet||t.loading||t.error?t._e():a("a",{staticClass:"udc-deposit-dialog--uniswap-url",attrs:{href:t.uniswapURL,target:"_blank"}},[t._v(" "+t._s(t.$t("udc-deposit-dialog.uniswap-url-title"))+" ")])],1),t.error?t._e():a("v-card-actions",[a("action-button",{staticClass:"udc-deposit-dialog__action",attrs:{arrow:"","full-width":"",enabled:t.valid&&!t.loading,text:t.$t(t.mainnet?"udc-deposit-dialog.button-main":"udc-deposit-dialog.button"),"data-cy":"udc_deposit_dialog_action"},on:{click:function(e){return t.udcDeposit()}}})],1)],1)},o=[],s=a(59312),r=a(5733),d=a(43535),c=a(57102),l=a(77382),u=a(31034),p=a(52291),h=a(11263),_=a(7674),m=a(53239),w=a(98071),g=a(93840),v=a(55679);(function(t){t["MINT"]="mint",t["APPROVE"]="approve",t["DEPOSIT"]="deposit",t["NONE"]="none"})(n||(n={}));let y=class extends c.w3{constructor(){super(...arguments),this.uniswapURL="",this.defaultUtilityTokenAmount="",this.step=n.NONE,this.loading=!1,this.error=null}cancel(){this.error=null}get utilityTokenBalance(){return g.Z.displayFormat(this.udcToken.balance,this.udcToken.decimals)}get valid(){let t;try{t=d.vz(this.defaultUtilityTokenAmount,this.udcToken.decimals)}catch(e){return!1}return this.mainnet?t.lte(this.udcToken.balance)&&t.gt(r._Y):t.gt(r._Y)}get currentStepDescription(){if(this.step===n.NONE)return"";{const t=`udc-deposit-dialog.progress.${this.step.toString()}`;return this.$t(t,{currency:this.udcToken.symbol})}}mounted(){var t;const e=null!==(t=this.$raiden.getMainAccount())&&void 0!==t?t:this.$raiden.getAccount(),a=d.dF(u.O6.mul(2));this.uniswapURL=`https://app.uniswap.org/#/swap?inputCurrency=ETH&outputCurrency=${this.udcToken.address}&exactAmount=${a}&exactField=outPUT&recipient=${e}`,this.defaultUtilityTokenAmount=this.mainnet?this.utilityTokenBalance:a}async udcDeposit(){this.error=null,this.loading=!0;const t=this.udcToken,e=v.D.parse(this.defaultUtilityTokenAmount,t.decimals);try{!this.mainnet&&e.gt(t.balance)&&(this.step=n.MINT,await this.$raiden.mint(t.address,e)),this.step=n.APPROVE,await this.$raiden.depositToUDC(e,(()=>{this.step=n.DEPOSIT})),this.$emit("done")}catch(a){this.error=a}this.step=n.NONE,this.loading=!1}};(0,s.__decorate)([(0,c.fI)({required:!0,type:Boolean})],y.prototype,"visible",void 0),(0,s.__decorate)([(0,c.y1)()],y.prototype,"cancel",null),y=(0,s.__decorate)([(0,c.wA)({components:{ActionButton:p.Z,RaidenDialog:_.Z,ErrorMessage:m.Z,Spinner:w.Z,AmountInput:h.Z},computed:{...(0,l.rn)("userDepositContract",{udcToken:"token"}),...(0,l.Se)(["mainnet"])}})],y);const f=y,b=f;var k=a(79917),C=a(43453),A=a.n(C),T=a(23399),x=(0,k.Z)(b,i,o,!1,null,"c3777994",null);const D=x.exports;A()(x,{VCardActions:T.h7,VCardSubtitle:T.Qq,VCardText:T.ZB,VCardTitle:T.EB})},25511:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>H});var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"udc",attrs:{"data-cy":"udc"}},[n("div",{staticClass:"udc__content-box"},[n("amount-display",{staticClass:"udc__amount",attrs:{amount:t.udcCapacity,token:t.udcToken}}),n("div",[t._v(" "+t._s(t._f("upperCase")(t.$t("udc.balance")))+" ")]),t.hasEnoughServiceTokens?t._e():n("div",{staticClass:"udc__content-box udc__content-box--nested"},[n("v-icon",{attrs:{color:"#84878A",size:"16px"}},[t._v("mdi-alert-outline")]),n("span",[t._v(" "+t._s(t.$t("udc.balance-too-low",{minAmount:t.minAmount,tokenSymbol:t.serviceTokenSymbol}))+" ")])],1)],1),n("div",{staticClass:"udc__actions"},[n("div",{staticClass:"udc__actions__button",attrs:{"data-cy":"udc__actions__button__deposit"},on:{click:function(e){t.showUdcDeposit=!0}}},[n("img",{attrs:{src:a(50939)}}),t._v(" "+t._s(t.$t("udc.deposit"))+" ")]),n("div",{staticClass:"udc__actions__button",attrs:{"data-cy":"udc__actions__button__withdrawal"},on:{click:function(e){t.withdrawFromUdc=!0}}},[n("img",{attrs:{src:a(63057)}}),t._v(" "+t._s(t.$t("udc.withdrawal"))+" ")])]),n("div",{staticClass:"udc__content-box"},[n("div",{staticClass:"udc__content-box__header"},[t._v(" "+t._s(t.$t("udc.withdrawal-header"))+" ")]),n("planned-udc-withdrawal-information",{attrs:{"planned-withdrawal":t.plannedUdcWithdrawal,"udc-token":t.udcToken}})],1),n("udc-deposit-dialog",{attrs:{visible:t.showUdcDeposit},on:{cancel:function(e){t.showUdcDeposit=!1},done:function(e){return t.mintDone()}}}),n("udc-withdrawal-dialog",{attrs:{visible:t.withdrawFromUdc,"account-balance":t.relevantEthBalanceForWithdrawal,token:t.udcToken,capacity:t.udcCapacity},on:{cancel:function(e){t.withdrawFromUdc=!1}}})],1)},i=[],o=a(59312),s=a(5733),r=a(43535),d=a(57102),c=a(77382),l=a(31034),u=a(52291),p=a(19261),h=a(54457),_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("raiden-dialog",{staticClass:"udc-withdrawal-dialog",attrs:{visible:t.visible,"data-cy":"udc-withdrawal-dialog"},on:{close:t.cancel}},[n("v-card-title",[t._v(t._s(t.$t("udc.withdrawal")))]),n("v-card-text",[t.inProgress?n("spinner",{staticClass:"udc-withdrawal-dialog__progress"}):t.error?n("error-message",{attrs:{error:t.error}}):t.isDone?[n("v-img",{staticClass:"udc-withdrawal-dialog__done my-4",attrs:{src:a(44036)}}),n("span",[t._v(t._s(t.$t("udc.withdrawal-planned")))])]:[n("amount-input",{staticClass:"udc-withdrawal-dialog__amount",attrs:{"data-cy":"udc-withdrawal-dialog__amount",token:t.tokenWithAsteriskAtSymbol,placeholder:t.$t("transfer.amount-placeholder"),autofocus:""},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}}),n("div",{staticClass:"udc-withdrawal-dialog__available-eth",class:{"udc-withdrawal-dialog__available-eth--too-low":t.accountBalanceTooLow}},[t._v(" "+t._s(t._f("upperCase")(t.$t("udc-deposit-dialog.available-eth",{balance:t.accountBalance,currency:t.$t("app-header.currency")})))+" ")])]],2),t.error||t.isDone?t._e():n("v-card-actions",{staticClass:"flex-column"},[n("action-button",{staticClass:"udc-withdrawal-dialog__button",attrs:{"data-cy":"udc-withdrawal-dialog__button",enabled:t.isValid&&!t.accountBalanceTooLow,text:t.$t("general.buttons.confirm"),"full-width":""},on:{click:t.planWithdraw}}),t.error?t._e():n("span",{staticClass:"mt-2"},[n("sup",[t._v(t._s(t.$t("udc.asterisk")))]),t._v(" "+t._s(t.$t("udc.withdrawal-footnote"))+" ")])],1)],1)},m=[],w=a(11263),g=a(7674),v=a(53239),y=a(98071),f=a(55679);let b=class extends d.w3{constructor(){super(...arguments),this.amount="0",this.inProgress=!1,this.error=null,this.isDone=!1}done(){this.isDone=!0,setTimeout((()=>{this.isDone=!1,this.cancel()}),5e3)}get accountBalanceTooLow(){return f.D.parse(this.accountBalance,18).lte(s._Y)}get tokenWithAsteriskAtSymbol(){return{...this.token,symbol:this.token.symbol+"*"}}get withdrawAmount(){let t;try{t=r.vz(this.amount,this.token.decimals)}catch(e){t=s._Y}return t}get isValid(){if(this.inProgress)return!1;const t=this.withdrawAmount;return t.gt(s._Y)&&t.lte(this.capacity)}async planWithdraw(){this.inProgress=!0;try{await this.$raiden.planUDCWithdraw(this.withdrawAmount),this.done()}catch(t){this.error=t}finally{this.inProgress=!1}}cancel(){this.isDone=!1,this.inProgress=!1,this.error=null,this.amount="0"}};(0,o.__decorate)([(0,d.fI)({required:!0,type:Boolean})],b.prototype,"visible",void 0),(0,o.__decorate)([(0,d.fI)({required:!0,type:String})],b.prototype,"accountBalance",void 0),(0,o.__decorate)([(0,d.fI)({required:!0})],b.prototype,"token",void 0),(0,o.__decorate)([(0,d.fI)({required:!0})],b.prototype,"capacity",void 0),(0,o.__decorate)([(0,d.y1)()],b.prototype,"cancel",null),b=(0,o.__decorate)([(0,d.wA)({components:{ErrorMessage:v.Z,RaidenDialog:g.Z,AmountInput:w.Z,ActionButton:u.Z,Spinner:y.Z},computed:{...(0,c.rn)("userDepositContract",{udcToken:"token"})}})],b);const k=b,C=k;var A=a(79917),T=a(43453),x=a.n(T),D=a(23399),U=a(55429),$=(0,A.Z)(C,_,m,!1,null,"4cce3ecf",null);const W=$.exports;x()($,{VCardActions:D.h7,VCardText:D.ZB,VCardTitle:D.EB,VImg:U.Z});var S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"planned-udc-withdrawal-information d-flex justify-center align-center px-2",class:{"planned-udc-withdrawal-information--no-progress":t.noWithdrawInProgress,"planned-udc-withdrawal-information--pending":t.isPending,"planned-udc-withdrawal-information--ready":t.isReady}},[t.noWithdrawInProgress?[t._v(" "+t._s(t._f("upperCase")(t.$t("udc.information.no-withdrawal-in-progress")))+" ")]:[n("img",{staticClass:"planned-udc-withdrawal-information__status-icon mr-2",attrs:{src:a(53980)("./status-icon-"+t.statusIconName+".svg"),width:"13px",height:"13px"}}),n("amount-display",{staticClass:"planned-udc-withdrawal-information__amount",attrs:{token:t.udcToken,amount:t.plannedWithdrawal.amount}}),n("v-spacer"),t.isPending?n("span",{staticClass:"planned-udc-withdrawal-information__message"},[t._v(" "+t._s(t._f("upperCase")(t.$t("udc.information.pending-message",[t.formattedWithdrawableAfterDate])))+" ")]):t._e(),t.isReady?n("span",{staticClass:"planned-udc-withdrawal-information__message"},[t._v(" "+t._s(t._f("upperCase")(t.$t("udc.information.ready-message")))+" ")]):t._e()]],2)},Z=[],E=a(55093);let B=class extends E.Z{constructor(){super(...arguments),this.assetSourceDirectory="@/assets/planned-udc-withdrawal",this.secondsUntilWithdrawable=0}get noWithdrawInProgress(){return void 0===this.plannedWithdrawal}get isPending(){return void 0!==this.plannedWithdrawal&&this.secondsUntilWithdrawable>0}get isReady(){return void 0!==this.plannedWithdrawal&&this.secondsUntilWithdrawable<=0}get formattedWithdrawableAfterDate(){if(this.plannedWithdrawal){const t=new Date(1e3*this.plannedWithdrawal.withdrawableAfter);return t.toLocaleString()}return""}get statusIconName(){return this.isReady?"ready":this.isPending?"pending":""}calculuateSecondsUntilWithdrawable(){var t,e;const a=Math.floor(Date.now()/1e3),n=null!==(t=null===(e=this.plannedWithdrawal)||void 0===e?void 0:e.withdrawableAfter)&&void 0!==t?t:0;this.secondsUntilWithdrawable=n?n-a:0}onPlannedWithdrawlChange(){this.calculuateSecondsUntilWithdrawable(),this.secondsUntilWithdrawable>0&&setTimeout(this.calculuateSecondsUntilWithdrawable,1e3*this.secondsUntilWithdrawable)}};(0,o.__decorate)([(0,d.fI)()],B.prototype,"plannedWithdrawal",void 0),(0,o.__decorate)([(0,d.fI)({required:!0})],B.prototype,"udcToken",void 0),(0,o.__decorate)([(0,d.RL)("plannedWithdrawal",{immediate:!0,deep:!0})],B.prototype,"onPlannedWithdrawlChange",null),B=(0,o.__decorate)([(0,d.wA)({components:{AmountDisplay:p.Z}})],B);const I=B,P=I;var V=a(41541),O=(0,A.Z)(P,S,Z,!1,null,null,null);const R=O.exports;x()(O,{VSpacer:V.Z});const{mapState:N}=(0,c._p)("userSettings"),{mapState:F}=(0,c._p)("userDepositContract"),q=10;let L=class extends d.w3{constructor(){super(...arguments),this.amount=r.dF(l.O6.mul(2)),this.minAmount=+r.dF(l.O6.add(l.O6.mul(q).div(100))),this.udcCapacity=s._Y,this.hasEnoughServiceTokens=!1,this.showUdcDeposit=!1,this.withdrawFromUdc=!1}get serviceTokenSymbol(){var t;return null!==(t=this.udcToken.symbol)&&void 0!==t?t:this.mainnet?"RDN":"SVT"}get relevantEthBalanceForWithdrawal(){return this.useRaidenAccount?this.raidenAccountBalance:this.accountBalance}async mounted(){await this.updateUDCCapacity()}async updateUDCCapacity(){const{monitoringReward:t}=this.$raiden;this.udcCapacity=await this.$raiden.getUDCCapacity(),this.hasEnoughServiceTokens=!(!t||!this.udcCapacity.gte(t))}async mintDone(){this.showUdcDeposit=!1,await this.updateUDCCapacity()}};L=(0,o.__decorate)([(0,d.wA)({components:{ActionButton:u.Z,UdcDepositDialog:h.Z,UdcWithdrawalDialog:W,AmountDisplay:p.Z,ErrorMessage:v.Z,Spinner:y.Z,PlannedUdcWithdrawalInformation:R},computed:{...(0,c.rn)(["accountBalance","raidenAccountBalance"]),...N(["useRaidenAccount"]),...F({udcToken:"token",plannedUdcWithdrawal:"plannedWithdrawal"}),...(0,c.Se)(["mainnet"])}})],L);const M=L,Y=M;var z=a(97660),j=(0,A.Z)(Y,n,i,!1,null,"219bc9c8",null);const H=j.exports;x()(j,{VIcon:z.Z})},53980:(t,e,a)=>{var n={"./status-icon-pending.svg":50184,"./status-icon-ready.svg":11272};function i(t){var e=o(t);return a(e)}function o(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}i.keys=function(){return Object.keys(n)},i.resolve=o,t.exports=i,i.id=53980},44036:(t,e,a)=>{"use strict";t.exports=a.p+"img/done.d303a316.svg"},50939:(t,e,a)=>{"use strict";t.exports=a.p+"img/icon-deposit.a683dd92.svg"},63057:(t,e,a)=>{"use strict";t.exports=a.p+"img/icon-withdraw.72a53756.svg"},50184:(t,e,a)=>{"use strict";t.exports=a.p+"img/status-icon-pending.a9957e3f.svg"},11272:(t,e,a)=>{"use strict";t.exports=a.p+"img/status-icon-ready.24cdc077.svg"}}]);